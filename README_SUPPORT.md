# üõ† –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üìû –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∏ troubleshooting

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã:**

#### 1. **–ú–µ—Ç—Ä–∏–∫–∏ Prometheus**
```bash
curl http://localhost:8000/metrics | grep telegram_bot
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫, –∫–æ–º–∞–Ω–¥, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 2. **GlitchTip**
```bash
curl http://localhost:8000/api/1/projects/
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤

#### 3. **–õ–æ–≥–∏ –±–æ—Ç–∞**
```bash
tail -f bot.log | grep -E "(ERROR|CRITICAL)"
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

#### 4. **–°—Ç–∞—Ç—É—Å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**
```bash
docker-compose ps
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Å—Ç–∞—Ç—É—Å–µ "Up"

---

## üêõ –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### **–ü—Ä–æ–±–ª–µ–º–∞: –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è**
**–°–∏–º–ø—Ç–æ–º—ã:** `curl http://localhost:8000/metrics` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω: `python new_bot.py`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 8000 —Å–≤–æ–±–æ–¥–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `config_local.py`

### **–ü—Ä–æ–±–ª–µ–º–∞: GlitchTip –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
**–°–∏–º–ø—Ç–æ–º—ã:** http://localhost:8000 –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose logs glitchtip

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart glitchtip

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
netstat -tlnp | grep 8000
```

### **–ü—Ä–æ–±–ª–µ–º–∞: –ê–ª–µ—Ä—Ç—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç**
**–°–∏–º–ø—Ç–æ–º—ã:** –û—à–∏–±–∫–∏ –µ—Å—Ç—å, –Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DEVELOPER_CHAT_ID` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ –≤ —á–∞—Ç–µ

### **–ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–≥–∏ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è**
**–°–∏–º–ø—Ç–æ–º—ã:** –§–∞–π–ª `bot.log` –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –ø–∞–ø–∫—É
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–≥–≥–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫:**

```python
# –í core/monitoring.py
self.new_metric = Counter('telegram_bot_custom_total', 'Description')

# –í handlers
metrics.new_metric.labels(type='example').inc()
```

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤:**

```python
# –í core/alerts.py
self.alert_rules['new_alert'] = {
    'enabled': True,
    'threshold': 50,
    'cooldown': 300,
    'last_alert': None
}
```

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

```python
# –í config_local.py
TELEGRAM_TOKEN = "your-bot-token"
CHAT_ID = "your-chat-id"
ENABLE_DEVELOPER_NOTIFICATIONS = True
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### **Health checks:**

#### 1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞:**
```bash
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥
```

#### 2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫:**
```bash
curl -s http://localhost:8000/metrics | grep "telegram_bot_status" | grep "1"
```

#### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ GlitchTip:**
```bash
curl -s http://localhost:8000/api/1/projects/ | grep -q "name" && echo "GlitchTip OK"
```

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫—É
python setup_monitoring.py

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
python final_test.py
```

---

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### **–î–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫:**

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
REDIS_URL = "redis://localhost:6379"
```

2. **–°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
# –í monitoring.py
traces_sample_rate = 0.1  # 10% —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```

3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ asyncio –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
await self._send_telegram_alert_async(...)
```

### **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**

1. **–û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –º–µ—Ç—Ä–∏–∫:**
```bash
# Prometheus –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
docker run -p 9090:9090 prom/prometheus
```

2. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏:**
```bash
# Nginx –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
upstream metrics {
    server localhost:8000;
}
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**

1. **–û–±–Ω–æ–≤–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:**
```python
# –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ counters/histograms
self.new_feature_metric = Counter('telegram_bot_new_feature_total')
```

2. **–û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
```markdown
<!-- –í MONITORING.md -->
### –ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- `telegram_bot_new_feature_total` - –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

3. **–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã:**
```python
def test_new_feature_metric():
    assert metrics.new_feature_metric._value.get() >= 0
```

4. **–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```python
# –í config_local.py
NEW_FEATURE_ENABLED = True
```

---

## üìû –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º

### **–£—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:**

#### üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è):
- –ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
- –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- –ê–ª–µ—Ä—Ç—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

#### üü° **–í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** (–≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞):
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞
- –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞

#### üîµ **–ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** (–≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è):
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£–ª—É—á—à–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### **–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ª–∏–¥:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `README_DEVELOPER.md`
- **–ö–æ–º–∞–Ω–¥–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `README_TEAM.md`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ README —Ñ–∞–π–ª–∞—Ö

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f bot.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
curl http://localhost:8000/metrics

# –°—Ç–∞—Ç—É—Å GlitchTip
docker-compose logs glitchtip
```

### **–û—Ç–ª–∞–¥–∫–∞:**
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
python final_test.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
python setup_monitoring.py

# –¢–µ—Å—Ç –º–µ—Ç—Ä–∏–∫
python test_metrics_simple.py
```

### **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ GlitchTip
docker-compose restart glitchtip

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose logs -f
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ

### **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ:**
1. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
2. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç

### **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:**
1. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–Ω–¥—ã –º–µ—Ç—Ä–∏–∫
2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### **–ï–∂–µ–º–µ—Å—è—á–Ω–æ:**
1. –ü—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
2. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
3. –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è

---

**–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è –ª–µ–≥–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è!** üöÄ

*–î–ª—è –∫–æ–º–∞–Ω–¥—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º*